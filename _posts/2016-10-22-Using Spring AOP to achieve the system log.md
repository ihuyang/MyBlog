---
layout: post
title:  "利用Spring AOP实现系统日志"
date:   2016-10-22 14:00:00
categories: java web
tags: featured
image: /assets/article_images/2016-10-22/title_img.jpg
image2: /assets/article_images/2016-10-22/title_img.jpg
---
### *摘要*
>　　我们可能都非常熟悉大名鼎鼎的OOP（面向对象编程），但却不一定清楚与它同为软件设计思想的AOP。从名称上来看，它们很相似，但两种设计思想在目标上却有着本质的区别。当前广泛被采用的开源框架Spring拥有两个重要的特征，一个是控制反转，另一个就是支持AOP编程，那么AOP到底是什么，它又能为我们的程序带来什么？
<br>
>　　在本文中，我将首先对AOP这一关键的设计思想进行介绍，之后我会使用Spring AOP去实现一个web系统的日志功能，这也是AOP非常重要的应用场景，通过这个例子可以加深我们对AOP的理解。如果你对该方面内容感兴趣，可以继续阅读下文。

# *1. AOP思想* #

- **AOP的概念**
<br>
　　AOP的全称是Aspect Oriented Programming，即**面向切面编程**，与OOP一样是一种软件设计的思想。AOP可以将程序中业务逻辑的各个部分隔离开来，将某些系统功能统一维护，从而达到降低业务逻辑耦合度的目的。
- **为什么需要AOP**
<br>
　　可能从上面简单的概念描述上，我们很难真正理解AOP的含义和特点。其实，当我们知道为什么需要AOP的时候，它的本质也就清楚了。我们知道，面向对象编程（OOP）将数据和对数据的操作封装成了统一的类以及具体的对象，这降低了代码的复杂程度，提高了重用性，让程序的结构变得更为清晰。但是OOP针对的是具有类似属性特征的对象，而不是行为特征，也就是说OOP会将属性类似的对象统一成类，而不是将行为类似的对象统一。我们可以设想，如果多个类都需要实现一个完全一样的方法，但这些类在属性上又不具有互相之间的继承关系，那么每个类就只能各自去实现这个方法了，结论就是OOP无法解决行为上的重用。可能你会说为什么不把这个特别的方法独立成另外一个类，其他类维护它的对象即可，但这样做实际上又会加深代码的耦合，这个类的任何变动都会影响到其他类的使用。
<br>
　　是的，这就是AOP设计出现的背景。OOP处理的是实体，封装了属性和操作，而AOP处理的是切面(切面这个概念将在后面一节说明)，封装了**行为**，它将几个类中共同的行为抽取出来，统一管理，在这些类需要的时候又将行为切入到指定的位置，跟之前直接在各个类中管理行为的结果是一样的。下图展示了AOP将公共行为抽象成切面后的场景，图中出现的切面、连接点等概念都会在下节中说明。

![AOP工作的场景](/assets/article_images/2016-10-22/2016-10-22_1.jpg "AOP工作的场景")

　　**总结一下，OOP和AOP就像是两个相互垂直的设计，OOP横向封装对象的属性和独有行为，而AOP纵向封装对象之间公有的行为，AOP是对OOP有力的补充**，让我们的程序结构变得更加清晰和易于管理。

- **AOP的适用场景**
<br>
　　既然知道了为什么需要AOP，自然它的适用场景就很容易想到了。在我们的程序中，有很多系统级的业务，它们穿插于各项普通业务的逻辑里，比如日志记录、异常管理、权限管理等等。这些系统业务当然可以直接写到各项普通业务的逻辑里，但这样就会有大量的代码重复出现，且过于混乱，不宜后期维护。这时候，就可以使用AOP将系统级业务抽出，统一管理，在适当的接入点将这些系统级业务重新插入普通业务中就可以了。

# *2. AOP的运用* #